# ScrollAnimation 滚动动画组件参数表

## CSS 类参数

| CSS 类名               | 主要属性/作用                               | 默认值 (部分示例)                  | 描述                                       |
| ---------------------- | ------------------------------------------- | ---------------------------------- | ------------------------------------------ |
| `.animate-on-scroll`   | opacity, transform, transition            | 0, scale(0.8) translateY(30px), all 0.6s ease-out | 基础动画类，定义元素初始状态和过渡         |
| `.animate-on-scroll.active` | opacity, transform                        | 1, none                            | 基础动画的激活状态，元素最终显示样式       |
| `.fade-up`             | opacity, transform, transition            | 0, translateY(30px), all 0.6s ease-out | 动画变体：从下向上淡入的初始状态           |
| `.fade-down`           | opacity, transform, transition            | 0, translateY(-30px), all 0.6s ease-out | 动画变体：从上向下淡入的初始状态           |
| `.fade-right`          | opacity, transform, transition            | 0, translateX(-30px), all 0.6s ease-out | 动画变体：从左向右淡入的初始状态           |
| `.fade-left`           | opacity, transform, transition            | 0, translateX(30px), all 0.6s ease-out | 动画变体：从右向左淡入的初始状态           |
| `.zoom-in`             | opacity, transform, transition            | 0, scale(0.8), all 0.6s ease-out | 动画变体：缩放淡入的初始状态               |
| `.fade-up.active`, `.fade-down.active`, `.fade-right.active`, `.fade-left.active`, `.zoom-in.active` | opacity, transform | 1, none                            | 所有动画变体的统一激活状态                 |
| `.delay-100`           | transition-delay                          | 0.1s                               | 动画延迟 100毫秒                           |
| `.delay-200`           | transition-delay                          | 0.2s                               | 动画延迟 200毫秒                           |
| `.delay-300`           | transition-delay                          | 0.3s                               | 动画延迟 300毫秒                           |
| `.delay-400`           | transition-delay                          | 0.4s                               | 动画延迟 400毫秒                           |
| `.delay-500`           | transition-delay                          | 0.5s                               | 动画延迟 500毫秒                           |
| *自定义激活类*         | (由 JS `options.activeClass` 指定)        | (默认为 `.active`)                 | JS 添加的用于触发动画的类                  |

## JavaScript 函数参数 (`initScrollAnimation`)

| 参数名        | 类型     | 必填 | 默认值                 | 描述                                                                                                |
| ------------- | -------- | ---- | ---------------------- | --------------------------------------------------------------------------------------------------- |
| `selector`    | string   | 否   | `'.animate-on-scroll'` | CSS 选择器，用于指定需要应用滚动动画的 HTML 元素。                                                  |
| `options`     | object   | 否   | `{}`                   | 配置选项对象。                                                                                      |
| `options.threshold` | number | 否 | `0.1`                  | 触发动画的元素可见比例阈值 (0 到 1)。例如，0.1 表示元素至少有 10% 进入视口时触发。                  |
| `options.activeClass` | string | 否 | `'active'`             | 当元素满足触发条件时，添加到该元素上的 CSS 类名。CSS 文件需要定义此类以实现动画的最终状态。         |
| `options.once` | boolean | 否 | `true`                 | 动画是否只触发一次。`true` 表示触发后即停止观察该元素；`false` 表示元素离开视口后会移除激活类，可重复触发。 |

**返回值:**

-   **`object`**: 如果找到匹配 `selector` 的元素，则返回一个控制器对象，包含以下方法：
    -   `refresh()`: 手动重新扫描 DOM，查找匹配 `selector` 且尚未激活的元素，并开始观察它们。适用于动态添加元素后。
    -   `disconnect()`: 停止 `IntersectionObserver` 对所有元素的观察。
-   **`undefined`**: 如果没有找到匹配 `selector` 的元素。

## 事件处理

| 事件             | 监听目标             | 处理逻辑                                                               | 功能                                       |
| ---------------- | -------------------- | ---------------------------------------------------------------------- | ------------------------------------------ |
| `DOMContentLoaded` | `document`           | 调用 `loadScrollAnimationStyles()`                                     | 自动加载组件所需的 CSS 样式文件            |
| `DOMContentLoaded` | `document`           | 调用 `initScrollAnimation()` (使用默认参数)                            | 自动初始化默认的滚动动画效果               |
| `IntersectionObserver` 回调 | (内部)             | 检查 `entry.isIntersecting`，根据 `options.once` 添加/移除 `activeClass` | 核心逻辑：检测元素可见性并触发/重置动画    |

## 错误处理与降级策略

| 情况                     | 处理方式                               | 用户体验影响                                     |
| ------------------------ | -------------------------------------- | ------------------------------------------------ |
| 未找到匹配 `selector` 的元素 | `console.warn` 输出警告，函数返回 `undefined` | 轻微 - 动画功能不生效，但页面其他部分不受影响    |
| CSS 样式加载失败         | 浏览器默认处理 (console 错误)          | 严重 - 动画完全不生效，因为没有定义初始和结束状态 |
| 重复初始化               | `console.log` 提示，直接返回已有的控制器 | 无 - 防止不必要的重复设置和潜在的性能问题        |

## 使用限制与最佳实践

| 限制/建议                | 描述                                                                 | 解决方案/注意                                                                 |
| ------------------------ | -------------------------------------------------------------------- | ----------------------------------------------------------------------------- |
| **CSS 依赖**             | 组件功能严重依赖于 `scrollAnimation.css` 文件中定义的动画和状态类。    | 确保 CSS 文件被正确加载（自动加载机制通常能处理）。                           |
| **性能考虑**             | 观察大量元素或使用复杂的动画可能会影响滚动性能，尤其是在低端设备上。   | 仅对必要的元素应用动画；避免过于复杂的 CSS 动画；`options.once: true` (默认) 有助于性能。 |
| **动态内容**             | 如果页面内容是动态加载的（例如通过 AJAX），新添加的元素不会自动应用动画。 | 在内容加载完成后，手动调用返回的控制器对象的 `refresh()` 方法来观察新元素。     |
| **阈值 (`threshold`) 选择** | `threshold` 值决定了元素需要进入视口多少才触发动画。过小可能过早触发，过大可能延迟触发。 | 根据具体元素大小和期望效果调整 `threshold` 值。                               |
| **可重复动画 (`once: false`)** | 设置 `once: false` 会在元素离开视口时移除激活类，可能导致动画频繁触发。 | 仅在确实需要重复动画效果时使用，并注意潜在的性能影响。                        |
| **浏览器兼容性**         | 依赖 `IntersectionObserver` API，不支持非常旧的浏览器 (如 IE)。        | 对于需要兼容旧浏览器的场景，可能需要 Polyfill 或备选方案。                    |
| **CSS 动画定义**         | JS 只负责添加/移除激活类，具体的动画效果完全由 CSS 定义。              | 确保 CSS 中 `.active` 类定义了元素动画完成后的最终状态 (`opacity: 1`, `transform: none`)。 |