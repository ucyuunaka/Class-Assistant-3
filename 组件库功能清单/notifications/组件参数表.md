# Notifications 通知组件参数表

## CSS 类参数

| CSS 类名                     | 主要属性/作用                                      | 默认值 (部分示例)                                  | 描述                                                         |
| ---------------------------- | -------------------------------------------------- | -------------------------------------------------- | ------------------------------------------------------------ |
| `.notification-container`    | position, top, right, z-index, display, gap        | fixed, 20px, 20px, 9999, flex, 10px                | 固定在页面右上角的通知容器                                   |
| `.notification`              | background, color, border-radius, box-shadow, padding, display, animation, border-left, transition | var(--background-color), var(--text-color), 12px, shadow, 0.9rem 1.1rem, flex, slideIn 0.3s forwards, 4px solid var(--primary-color), all 0.3s | 单个通知的基础样式、入场动画和左侧边框                       |
| `.notification:hover`        | box-shadow, transform                              | enhanced shadow, translateY(-2px)                  | 通知悬停时的交互效果                                         |
| `.notification-content`      | display, align-items, gap, font-size, line-height  | flex, center, 0.85rem, 0.95rem, 1.4                | 通知内部内容区域（图标和文本）                               |
| `.notification-content i`    | font-size                                          | 1.3rem                                             | 通知图标样式                                                 |
| `.notification-close`        | background, border, color, cursor, font-size, padding, border-radius, transition | transparent, none, var(--text-secondary), pointer, 1.2rem, 6px, 50%, all 0.2s | 关闭按钮样式                                                 |
| `.notification-close:hover`  | opacity, background-color                          | 1, rgba(0,0,0,0.05)                                | 关闭按钮悬停效果                                             |
| `.notification-success`      | border-left-color, background-color                | var(--success-color), rgba(var(--success-color-rgb), 0.03) | 成功类型通知的特定样式                                       |
| `.notification-success i`    | color                                              | var(--success-color)                               | 成功类型通知的图标颜色                                       |
| `.notification-error`        | border-left-color, background-color                | var(--danger-color), rgba(var(--danger-color-rgb), 0.03) | 错误类型通知的特定样式                                       |
| `.notification-error i`      | color                                              | var(--danger-color)                                | 错误类型通知的图标颜色                                       |
| `.notification-warning`      | border-left-color, background-color                | var(--warning-color), rgba(var(--warning-color-rgb), 0.05) | 警告类型通知的特定样式                                       |
| `.notification-warning i`    | color, animation                                   | var(--warning-color), pulseWarning 2s infinite     | 警告类型通知的图标颜色和脉冲动画                             |
| `.notification-info`         | border-left-color, background-color                | var(--primary-color), rgba(var(--primary-color-rgb), 0.03) | 信息类型通知的特定样式 (默认)                                |
| `.notification-info i`       | color                                              | var(--primary-color)                               | 信息类型通知的图标颜色                                       |
| `.notification-actions`      | margin-left, margin-right                          | auto, 8px                                          | 操作按钮容器                                                 |
| `.notification-action`       | background, border, color, font-weight, cursor, font-size, padding, border-radius, transition | none, 1px solid currentColor, var(--primary-color), 500, pointer, 0.85rem, 5px 10px, 8px, all 0.2s | 可选操作按钮的样式                                           |
| `.notification-action:hover` | background-color, transform, opacity, box-shadow   | rgba(var(--primary-color-rgb), 0.1), translateY(-1px), 1, shadow | 操作按钮悬停效果                                             |
| `.fade-in`                   | animation                                          | slideIn 0.3s forwards                              | 应用于通知元素，触发滑入动画 (JS 自动添加)                   |
| `.fade-out`                  | animation                                          | fadeOut 0.3s forwards                              | 应用于通知元素，触发淡出动画 (JS 在关闭时添加)               |
| `[data-theme="dark"] ...`    | (各种)                                             | (调整后的颜色、阴影等)                             | 深色模式下的样式覆盖                                         |

## JavaScript 函数参数

### `showNotification(message, type = 'info', duration = 3000, hasAction = false, action = null)`

| 参数名      | 类型     | 必填 | 默认值   | 描述                                                                                                |
| ----------- | -------- | ---- | -------- | --------------------------------------------------------------------------------------------------- |
| `message`   | string   | 是   | -        | 要在通知中显示的主要文本内容。                                                                      |
| `type`      | string   | 否   | `'info'` | 通知类型，决定样式和图标。可选值：`'info'`, `'success'`, `'warning'`, `'error'`。                     |
| `duration`  | number   | 否   | `3000`   | 通知自动关闭前的显示时长（毫秒）。设置为 `0` 或负数表示通知不会自动关闭，需要手动点击关闭按钮。         |
| `hasAction` | boolean  | 否   | `false`  | 是否在通知中显示一个操作按钮。如果为 `true`，则需要提供 `action` 参数。                               |
| `action`    | object   | 否   | `null`   | 当 `hasAction` 为 `true` 时提供。一个包含 `text` (string, 按钮文字) 和 `onClick` (function, 点击回调函数) 的对象。 |

**返回值:**

-   **`object`**: 一个包含以下内容的对象：
    -   `close()`: 一个函数，调用它可以手动关闭这个特定的通知（触发淡出动画并移除元素）。
    -   `element`: 对创建的通知 DOM 元素的引用。

### `showDevelopingNotification(featureName = '', duration = 3000)`

| 参数名        | 类型   | 必填 | 默认值   | 描述                                                         |
| ------------- | ------ | ---- | -------- | ------------------------------------------------------------ |
| `featureName` | string | 否   | `''`     | 可选的功能名称，将包含在“功能正在开发中”的提示信息里。       |
| `duration`    | number | 否   | `3000`   | 通知自动关闭前的显示时长（毫秒）。                           |

**返回值:**

-   **`object`**: 同 `showNotification` 返回的对象，允许手动关闭。

## CSS 变量依赖

| 变量名                 | 用途示例                                                     | 默认值来源 (可能) |
| ---------------------- | ------------------------------------------------------------ | ----------------- |
| `--background-color`   | 通知背景色 (亮/暗)                                           | `themes.css`      |
| `--text-color`         | 通知主要文本颜色 (亮/暗)                                     | `themes.css`      |
| `--text-secondary`     | 关闭按钮颜色 (亮/暗)                                         | `themes.css`      |
| `--primary-color`      | 信息类型边框/图标颜色, 操作按钮颜色/边框 (亮)                | `themes.css`      |
| `--success-color`      | 成功类型边框/图标颜色, 操作按钮颜色/边框 (亮)                | `themes.css`      |
| `--danger-color`       | 错误类型边框/图标颜色, 操作按钮颜色/边框 (亮)                | `themes.css`      |
| `--warning-color`      | 警告类型边框/图标颜色, 操作按钮颜色/边框 (亮)                | `themes.css`      |
| `--primary-color-rgb`  | 用于计算信息类型背景色的 `rgba()`                            | `themes.css`      |
| `--success-color-rgb`  | 用于计算成功类型背景色的 `rgba()`                            | `themes.css`      |
| `--danger-color-rgb`   | 用于计算错误类型背景色的 `rgba()`                            | `themes.css`      |
| `--warning-color-rgb`  | 用于计算警告类型背景色的 `rgba()`                            | `themes.css`      |

*注意：具体默认值取决于 `themes.css` 中的定义。RGB 变量通常是对应颜色变量的 RGB 值表示，用于 `rgba()` 函数。*

## 事件处理

| 事件             | 监听目标                   | 处理逻辑                                                     | 功能                                       |
| ---------------- | -------------------------- | ------------------------------------------------------------ | ------------------------------------------ |
| `DOMContentLoaded` | `document`                 | 调用 `loadNotificationStyles()`, `initNotificationContainer()` | 自动加载样式并初始化通知容器               |
| `click`          | `.notification-close`      | 添加 `.fade-out` 类，延时后移除元素                          | 处理手动关闭通知                           |
| `click`          | `.notification-action`     | 调用 `action.onClick` 回调函数                               | 处理可选操作按钮的点击事件                 |
| `themeChanged`   | `window` (自定义)          | `console.log` 记录主题变化 (当前无其他 JS 操作)              | 响应主题切换事件 (样式由 CSS 变量处理)     |

## 错误处理与降级策略

| 情况                     | 处理方式                                                     | 用户体验影响                                     |
| ------------------------ | ------------------------------------------------------------ | ------------------------------------------------ |
| CSS 样式加载失败         | 浏览器默认处理 (console 错误)                                | 严重 - 通知功能可能正常，但样式完全丢失          |
| 容器初始化失败 (理论上少见) | 如果 `document.body` 不存在，会报错；如果容器已存在则跳过。 | 严重/无 - 取决于页面结构是否异常                 |
| `localStorage` 读取失败  | `getMaxNotificationsCount` 使用默认值 `3`。                  | 轻微 - 通知数量限制功能使用默认值                |
| 全局函数被覆盖           | `ensureNotificationSystem` 尝试在 5 秒后恢复 `window.showNotification`。 | 可能暂时失效 - 如果其他脚本覆盖了通知函数，通知可能在短时间内无法触发，之后会尝试恢复。 |

## 使用限制与最佳实践

| 限制/建议                | 描述                                                                 | 解决方案/注意                                                                 |
| ------------------------ | -------------------------------------------------------------------- | ----------------------------------------------------------------------------- |
| **图标库依赖**           | JS 代码中硬编码了 Font Awesome 的 CSS 类名 (`fas fa-*`)。              | 确保项目中已引入 Font Awesome (v5 Free) 图标库。如需更换，需修改 JS 代码。    |
| **全局函数**             | 默认将 `showNotification` 和 `showDevelopingNotification` 暴露到 `window` 对象。 | 在模块化项目中，推荐通过 `import` 使用导出的函数，避免全局污染。              |
| **数量限制配置**         | 最大通知数量通过 `localStorage` 的 `maxNotifications` 项配置。       | 如果需要更灵活或持久化的配置方式，需修改 `getMaxNotificationsCount` 函数。    |
| **动画效果**             | 动画效果由 CSS 定义，JS 仅负责添加/移除触发类。                      | 如需修改动画，应编辑 `notifications.css` 中的 `@keyframes` 和 `transition`。    |
| **容器位置**             | 通知容器固定在右上角，如需更改位置，需修改 `.notification-container` 的 CSS。 | 直接修改 `notifications.css` 中 `.notification-container` 的 `top`, `right`, `bottom`, `left` 属性。 |
| **操作按钮限制**         | 目前仅支持最多一个操作按钮。                                         | 如需多个按钮，需要修改 JS 创建逻辑和 CSS 样式。                               |
| **消息内容**             | `message` 参数会被直接插入 HTML，应确保内容安全，避免 XSS 风险。       | 对来自用户输入或不可信来源的消息进行适当的转义或清理。                        |