# Sidebar 侧边栏组件参数表

## CSS 类参数

| CSS 类名                     | 主要属性/作用                                  | 默认值 (部分示例)                     | 描述                                       |
| ---------------------------- | ---------------------------------------------- | ------------------------------------- | ------------------------------------------ |
| `.sidebar`                   | width, height, background, transition, position | 110px, 100vh, #f5f7fa, 0.4s, fixed    | 侧边栏主容器基础样式                       |
| `[data-theme="dark"] .sidebar` | background                                     | #0d1117                               | 暗色模式下侧边栏背景                       |
| `.sidebar:hover`             | width                                          | 280px                                 | 桌面端悬停时展开宽度                       |
| `.sidebar.active`            | width, opacity, visibility                   | 280px, 1, visible                     | 移动端激活时样式                           |
| `.sidebar-hover-overlay`     | position, background, opacity, transition      | fixed, rgba(0,0,0,0.4), 0, 0.3s       | 桌面端悬停时显示的遮罩层                   |
| `.sidebar-hover-overlay.active`| opacity, visibility                          | 1, visible                            | 激活状态的桌面遮罩层                       |
| `.sidebar-btn`               | width, height, display, margin               | 60px, 10px, flex, 25px 0 0 25px       | 顶部模拟按钮组容器                         |
| `.sidebar-btn-item`          | width, height, border-radius                 | 10px, 10px, 50%                       | 模拟按钮项                                 |
| `.sidebar-profile`           | width, height, display, margin               | 250px, 60px, flex, 20px 0 0 25px      | 用户信息区域容器                           |
| `.sidebar-profile-img`       | width, height, border-radius, border, overflow | 60px, 60px, 50%, 4px solid rgba(0,0,0,0.1), hidden | 用户头像容器                               |
| `.sidebar-profile-text`      | height, margin-left                          | 60px, 25px                            | 用户文本信息容器                           |
| `.sidebar-line`              | width, height, background, margin, transition  | 60px, 1px, var(--border-color), 20px 25px, 0.5s | 分隔线                                     |
| `.sidebar:hover .sidebar-line`| width                                          | 230px                                 | 侧边栏展开时分隔线宽度                     |
| `.sidebar-title`             | width, margin                                | 60px, 0 0 20px 25px                   | 菜单区域标题容器                           |
| `.sidebar-menu`              | width, margin-left                           | 230px, 25px                           | 菜单项容器                                 |
| `.sidebar-item`              | display, position, transition, border-radius | flex, relative, 0.5s, 6px             | 单个菜单项基础样式                         |
| `.sidebar-item:hover`        | background-color                             | rgba(0, 0, 0, 0.05)                   | 菜单项悬停/激活背景 (亮色)                 |
| `.sidebar-item.active`       | background-color                             | rgba(0, 0, 0, 0.05)                   | 菜单项悬停/激活背景 (亮色)                 |
| `.sidebar-item.touch-active` | background-color                             | rgba(0, 0, 0, 0.1)                    | 触摸设备点击反馈 (亮色)                    |
| `.sidebar-icon-left`         | width, height, display, justify-content      | 60px, 50px, flex, center              | 菜单项左侧图标容器                         |
| `.sidebar-text`              | width, height, transition, opacity, left     | 0px, 50px, 0.5s, 0, -20px             | 菜单项文本容器 (默认隐藏)                  |
| `.sidebar:hover .sidebar-text`| width, opacity, left                         | 160px, 1, 0                           | 侧边栏展开时文本容器样式                   |
| `.sidebar-icon-right`        | width, height, transition, opacity           | 0px, 50px, 0.5s, 0                    | 菜单项右侧图标容器 (默认隐藏)              |
| `.sidebar:hover .sidebar-icon-right`| width, opacity                         | 60px, 1                               | 侧边栏展开时右侧图标样式                   |
| `.sidebar-light`             | width, height, background, position, left, opacity | 6px, 50px, var(--primary-color), absolute, -25px, 0 | 激活菜单项的高亮条 (默认隐藏)              |
| `.sidebar-item.active .sidebar-light`| opacity                              | 1                                     | 激活时高亮条可见                           |
| `.sidebar-active`            | padding-left, transition                     | 110px, 0.4s                           | 应用于主内容区，用于桌面端布局调整         |
| `.sidebar:hover ~ .sidebar-active`| padding-left                             | 280px                                 | 桌面端侧边栏悬停时主内容区内边距           |
| `.footer`                    | margin-left, width, transition               | 110px, calc(100% - 110px), 0.4s       | 页脚布局调整 (桌面端)                      |
| `.sidebar:hover ~ .footer`   | margin-left, width                           | 280px, calc(100% - 280px)             | 桌面端侧边栏悬停时页脚布局调整             |
| `.sidebar-toggle`            | position, top, left, background, width, height | fixed, 15px, 15px, var(--primary-color), 40px, 40px | 移动端切换按钮                             |
| `.sidebar-overlay`           | position, background, z-index, opacity, transition | fixed, rgba(0,0,0,0.5), 1001, 0, 0.3s | 移动端激活时显示的遮罩层                   |
| `.sidebar-overlay.active`    | opacity, visibility                          | 1, visible                            | 激活状态的移动端遮罩层                     |

## HTML 结构参数 (`sidebar.html`)

| 元素选择器             | 主要作用         | 子元素/属性示例                                     | 描述                                       |
| ---------------------- | ---------------- | --------------------------------------------------- | ------------------------------------------ |
| (Root)                 | 侧边栏内容根     | `.sidebar-btn`, `.sidebar-profile`, ...             | 由 JS 加载到指定容器内                     |
| `.sidebar-btn`         | 顶部按钮组       | `.sidebar-btn-item` (x3)                            | 模拟窗口控制按钮                           |
| `.sidebar-profile`     | 用户信息区域     | `.sidebar-profile-img`, `.sidebar-profile-text`     | 显示用户头像和名称/欢迎语                  |
| `.sidebar-profile-img` | 用户头像容器     | `img`                                               | 包裹用户头像图片                           |
| `.sidebar-profile-text`| 用户文本容器     | `p`, `h2`                                           | 显示欢迎语和应用名称                       |
| `.sidebar-line`        | 分隔线           | -                                                   | 用于分隔侧边栏不同区域                     |
| `.sidebar-title`       | 区域标题         | `p`                                                 | 显示菜单区域标题（如“主菜单”）            |
| `.sidebar-menu`        | 菜单项容器       | `.sidebar-item` (多个)                              | 包裹一组菜单项                             |
| `.sidebar-item`        | 单个菜单项       | `.sidebar-light`, `.sidebar-icon-left`, `.sidebar-text`, `.sidebar-icon-right`, `data-href` | 可点击的导航项，包含图标、文本和高亮状态 |
| `.sidebar-light`       | 激活状态指示器   | -                                                   | 菜单项激活时显示的左侧竖条                 |
| `.sidebar-icon-left`   | 左侧图标容器     | `i` (Remixicon)                                     | 显示菜单项的主要图标                       |
| `.sidebar-text`        | 菜单项文本       | 文本                                                | 显示菜单项名称                             |
| `.sidebar-icon-right`  | 右侧图标容器     | `i` (Remixicon)                                     | 侧边栏展开时显示的附加图标                 |
| `[data-href]`          | 导航链接属性     | URL 字符串 (e.g., "/index.html")                    | 定义菜单项点击后跳转的目标页面             |

## JavaScript 类和方法参数 (`Sidebar` 类)

| 属性/方法                   | 类型     | 功能                                       | 参数                               | 返回值        |
| --------------------------- | -------- | ------------------------------------------ | ---------------------------------- | ------------- |
| `constructor(containerId)`  | 构造函数 | 创建 Sidebar 实例，指定容器 ID             | `containerId` (string, required)   | `Sidebar` 实例 |
| `init()`                    | 方法     | 初始化组件：加载样式、内容，设置事件监听   | 无                                 | `void`        |
| `loadStyles()`              | 方法     | 动态加载 `sidebar.css` 样式文件            | 无                                 | `void`        |
| `loadSidebarContent()`      | 方法     | 加载 `sidebar.html` 内容并初始化后续功能   | 无                                 | `Promise<void>` |
| `createOverlay()`           | 方法     | 创建桌面端悬停时使用的遮罩层元素           | 无                                 | `void`        |
| `initSidebar()`             | 方法     | 初始化菜单点击、高亮、移动端切换等核心功能 | 无                                 | `void`        |
| `setupMobileToggle()`       | 方法     | 创建并设置移动端切换按钮和遮罩层的事件监听 | 无                                 | `void`        |
| `initSidebarHover()`        | 方法     | 设置桌面端悬停显示/隐藏遮罩层的逻辑        | 无                                 | `void`        |
| `listenForThemeChanges()`   | 方法     | 监听 `themeChanged` 自定义事件             | 无                                 | `void`        |
| `highlightCurrentMenuItem(pageName)` | 方法 | 根据当前页面路径高亮对应菜单项             | `pageName` (string, optional)      | `void`        |
| `toggleSidebar(show = null)`| 方法     | 控制移动端侧边栏的显示/隐藏状态            | `show` (boolean \| null, optional) | `void`        |
| `setupTouchHandlers()`      | 方法     | 添加针对触摸设备的优化处理（反馈、滚动）   | 无                                 | `void`        |
| `loadUserAvatar()`          | 方法     | 从 `localStorage` 加载用户头像             | 无                                 | `void`        |
| `listenForAvatarUpdates()`  | 方法     | 监听 `user-avatar-updated` 事件更新头像    | 无                                 | `void`        |
| `containerId`               | 属性     | 存储侧边栏容器的 DOM ID                    | -                                  | `string`      |
| `container`                 | 属性     | 侧边栏容器的 DOM 元素引用                  | -                                  | `HTMLElement` |
| `overlay`                   | 属性     | 桌面端悬停遮罩层 DOM 元素引用              | -                                  | `HTMLElement` |
| `isTouchDevice`             | 属性     | 标记是否为触摸设备                         | -                                  | `boolean`     |

## CSS 变量依赖

| 变量名                 | 用途示例                                     | 默认值来源 (可能) |
| ---------------------- | -------------------------------------------- | ----------------- |
| `--background`         | 侧边栏背景 (亮色)                            | `themes.css`      |
| `--background-secondary` | - (可能用于内部元素)                         | `themes.css`      |
| `--text-color`         | 主要文本颜色 (亮色)                          | `themes.css`      |
| `--text-secondary`     | 次要文本颜色 (亮色)                          | `themes.css`      |
| `--primary-color`      | 主题色 (高亮条、移动端按钮背景、右侧图标)    | `themes.css`      |
| `--border-color`       | 分隔线颜色 (亮色)                            | `themes.css`      |
| `--shadow-lg`          | 侧边栏阴影                                   | `styles.css`      |
| `--shadow`             | 移动端切换按钮阴影                           | `styles.css`      |
| `--danger-color`       | 模拟按钮项颜色                               | `themes.css`      |
| `--warning-color`      | 模拟按钮项颜色                               | `themes.css`      |
| `--success-color`      | 模拟按钮项颜色                               | `themes.css`      |

*注意：具体默认值取决于 `themes.css` 和 `styles.css` 中的定义。*

## 响应式断点

| 断点                             | 影响的 CSS 类/元素                                  | 主要变化描述                                                                                                                               |
| -------------------------------- | --------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
| `max-width: 768px`               | `.sidebar`, `.sidebar-active`, `.footer`, `.sidebar-toggle`, `.sidebar-overlay`, `.sidebar-text`, `.sidebar-icon-right`, `.sidebar-line` | 侧边栏默认隐藏，通过 `.sidebar-toggle` 按钮和 `.active` 类控制显隐；使用独立的 `.sidebar-overlay`；菜单项文本/右图标始终可见；主内容/页脚无边距调整。 |
| `min-width: 769px`               | `.sidebar`, `.sidebar-active`, `.footer`, `.sidebar-hover-overlay` | 侧边栏默认窄条显示，悬停展开；使用 `.sidebar-hover-overlay`；主内容/页脚根据侧边栏状态调整 `padding-left`/`margin-left`。                     |
| `min-width: 769px and max-width: 1024px` | `.footer`                                           | 针对中等屏幕，确保悬停时页脚边距正确调整。                                                                                                 |

## 事件处理

| 事件                 | 监听目标             | 处理方法/逻辑                                       | 功能                                       |
| -------------------- | -------------------- | --------------------------------------------------- | ------------------------------------------ |
| `DOMContentLoaded`   | `document`           | `loadGlobalUserAvatar`, `new Sidebar()`             | 初始化头像加载和侧边栏实例                 |
| `fetch` (Promise)    | - (内部)             | `loadSidebarContent` 内处理                         | 加载 HTML 模板                             |
| `click`              | `.sidebar-item` (委托) | `initSidebar` 内处理                                | 处理菜单项点击导航，移动端关闭侧边栏       |
| `click`              | `.sidebar-toggle`    | `setupMobileToggle` 内调用 `toggleSidebar()`        | 切换移动端侧边栏显示/隐藏                  |
| `click`              | `.sidebar-overlay`   | `setupMobileToggle` 内调用 `toggleSidebar(false)`   | 点击移动端遮罩层关闭侧边栏                 |
| `touchstart`         | `.sidebar-overlay`   | `setupMobileToggle` 内调用 `toggleSidebar(false)`   | 触摸移动端遮罩层关闭侧边栏                 |
| `mouseenter`         | `container`          | `initSidebarHover` 内添加 `.active` 到 `overlay`    | 显示桌面端悬停遮罩层                       |
| `mouseleave`         | `container`          | `initSidebarHover` 内移除 `overlay` 的 `.active`    | 隐藏桌面端悬停遮罩层                       |
| `mouseenter`         | `overlay`            | `initSidebarHover` 内移除自身的 `.active`           | 防止桌面遮罩层拦截鼠标事件                 |
| `resize`             | `window`             | `initSidebar` 内处理                                | 在移动/桌面视图切换时调整侧边栏状态和样式  |
| `themeChanged`       | `window` (自定义)    | `listenForThemeChanges` 内监听 (当前无具体 JS 操作) | 响应主题切换事件                           |
| `user-avatar-updated`| `document` (自定义)  | `listenForAvatarUpdates` 内更新 `img.src`           | 响应头像更新事件，同步侧边栏头像           |
| `touchstart`         | `.sidebar-item` (委托) | `setupTouchHandlers` 内添加 `.touch-active`         | 添加触摸点击反馈样式                       |
| `touchend`           | `container`          | `setupTouchHandlers` 内移除 `.touch-active`         | 移除触摸点击反馈样式                       |
| `touchmove`          | `document.body`      | `setupTouchHandlers` 内 `preventDefault()`          | 移动端侧边栏打开时阻止背景滚动             |

## 错误处理与降级策略

| 错误情况                 | 处理方式                                       | 用户体验影响                                     |
| ------------------------ | ---------------------------------------------- | ------------------------------------------------ |
| 容器元素未找到           | `console.error` 输出错误，停止初始化           | 严重 - 侧边栏完全不显示                          |
| `sidebar.html` 加载失败  | `console.error` 输出错误，容器内显示错误消息   | 中等 - 侧边栏区域可见但无内容和功能              |
| `sidebar.css` 加载失败   | 浏览器默认处理 (console 错误)                  | 中等 - 侧边栏功能可能正常，但样式完全丢失        |
| `localStorage` 读取失败  | `loadUserAvatar` 静默失败，使用默认头像        | 轻微 - 显示默认头像而非用户自定义头像            |
| 自定义事件未触发         | 依赖事件的功能 (头像/主题更新) 不会执行        | 轻微/中等 - 取决于功能重要性                     |

## 使用限制与最佳实践

| 限制/建议                | 描述                                                                 | 解决方案/注意                                                                 |
| ------------------------ | -------------------------------------------------------------------- | ----------------------------------------------------------------------------- |
| **容器 ID**              | 必须提供一个唯一的 DOM 元素 ID 用于初始化 `Sidebar` 类。               | 在 HTML 中确保 `<aside id="your-id">` 或类似元素存在，并将 ID 传给构造函数。    |
| **资源路径**             | JS/CSS 使用绝对路径 (`/components/sidebar/...`) 加载资源。             | 确保 Vite 开发服务器或生产构建配置能正确解析这些路径。                        |
| **CSS 变量依赖**         | 组件样式依赖于外部定义的 CSS 变量 (主题色、背景色、阴影等)。         | 确保在全局样式 (`themes.css`, `styles.css`) 中定义了这些变量。                |
| **图标库依赖**           | HTML 模板中使用了 Remixicon 图标类名 (`ri-*`)。                      | 确保已在项目中引入 Remixicon 字体文件或 CSS。                                 |
| **主内容/页脚协同**      | 桌面端需要主内容区和页脚配合 `.sidebar-active` 类及相应 CSS 进行布局调整。 | 在主内容 `<main>` 或 `<body>` 上添加 `.sidebar-active` 类，并定义相应的 CSS 规则。 |
| **头像持久化**           | 头像依赖 `localStorage` 的 `userAvatar` 项。                         | 确保在用户设置头像的地方正确写入 `localStorage`。                             |
| **自定义事件**           | 头像和主题更新依赖外部触发的 `user-avatar-updated` 和 `themeChanged` 事件。 | 确保在需要更新头像或切换主题时，正确地 `dispatchEvent` 这些自定义事件。         |
| **HTML 结构固定**        | 侧边栏内部结构由 `sidebar.html` 定义，JS 主要负责加载和交互。        | 如需大幅修改结构，应直接编辑 `sidebar.html` 文件。                            |
| **移动端覆盖**           | 移动端侧边栏激活时会覆盖在主内容之上。                               | 这是常见模式，但需注意确保重要内容不被完全遮挡。                              |